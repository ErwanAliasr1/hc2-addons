{"name":"Countdown","type":"virtual_device","properties":{"deviceIcon":1,"currentIcon":"19","log":"","logTemp":"","mainLoop":"local nbHeure = 24\n\nlocal i = 0\nwhile true do\n\tif (i >= (nbHeure*2) or i == 0) then\n    \ti = 0\n\t\tfibaro:call(fibaro:getSelfId(), \"pressButton\", \"3\")\nend\n\tfibaro:sleep(30*60*1000)\n \ti = i + 1\nend","ui.Label1.value":"172","ui.Label2.value":"15.03.2016","visible":"true","rows":[{"type":"label","elements":[{"id":1,"lua":false,"waitForResponse":false,"caption":"Jours restant","name":"Label1","favourite":false,"main":true}]},{"type":"label","elements":[{"id":2,"lua":false,"waitForResponse":false,"caption":"Jusqu'au","name":"Label2","favourite":false,"main":false}]},{"type":"button","elements":[{"id":3,"lua":true,"waitForResponse":false,"caption":"Rafraichir","name":"Button11","empty":false,"msg":"local date_delai = \"15.03.2016\"\n\nday,month,year = date_delai:match(\"(%d+).(%d+).(%d+)\")\nlocal dated = os.time({day=day,month=month,year=year,hour=0,min=0,sec=0})\n\ndiff = os.difftime(dated, os.time())\n\nlocal days = math.floor(diff / (60*60*24))+1\n\nfibaro:call(fibaro:getSelfId(), \"setProperty\", \"ui.Label1.value\", days..\"\")\nfibaro:call(fibaro:getSelfId(), \"setProperty\", \"ui.Label2.value\", date_delai)\n\n--if (days < 10) then\n--  fibaro:call(108, \"sendPush\", \"Remplacer le filtre Brita\")\n--end","buttonIcon":19,"favourite":false,"main":true}]}]},"actions":{"pressButton":1,"setSlider":2,"setProperty":2}}