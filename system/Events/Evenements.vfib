{"name":"EvÃ©nements","type":"virtual_device","properties":{"deviceIcon":0,"currentIcon":"1088","mainLoop":"fibaro:call(fibaro:getSelfId(), \"pressButton\", \"11\")","saveLogs":"1","ui.Label1.value":"Tablette [Cuisine] | 1->0 | 02:42:20","ui.Label10.value":"","ui.Label2.value":"","ui.Label3.value":"","ui.Label4.value":"","ui.Label5.value":"","ui.Label6.value":"","ui.Label7.value":"","ui.Label8.value":"","ui.Label9.value":"","rows":[{"type":"label","elements":[{"id":1,"lua":false,"waitForResponse":false,"caption":"","name":"Label1","favourite":false,"main":false}]},{"type":"label","elements":[{"id":2,"lua":false,"waitForResponse":false,"caption":"","name":"Label2","favourite":false,"main":false}]},{"type":"label","elements":[{"id":3,"lua":false,"waitForResponse":false,"caption":"","name":"Label3","favourite":false,"main":false}]},{"type":"label","elements":[{"id":4,"lua":false,"waitForResponse":false,"caption":"","name":"Label4","favourite":false,"main":false}]},{"type":"label","elements":[{"id":5,"lua":false,"waitForResponse":false,"caption":"","name":"Label5","favourite":false,"main":false}]},{"type":"label","elements":[{"id":6,"lua":false,"waitForResponse":false,"caption":"","name":"Label6","favourite":false,"main":false}]},{"type":"label","elements":[{"id":7,"lua":false,"waitForResponse":false,"caption":"","name":"Label7","favourite":false,"main":false}]},{"type":"label","elements":[{"id":8,"lua":false,"waitForResponse":false,"caption":"","name":"Label8","favourite":false,"main":false}]},{"type":"label","elements":[{"id":9,"lua":false,"waitForResponse":false,"caption":"","name":"Label9","favourite":false,"main":false}]},{"type":"label","elements":[{"id":10,"lua":false,"waitForResponse":false,"caption":"","name":"Label10","favourite":false,"main":false}]},{"type":"button","elements":[{"id":11,"lua":true,"waitForResponse":false,"caption":"Rafraichir","name":"btnRefresh","empty":false,"msg":"local user = \"admin\"\nlocal pwd = \"password\"\n\nHC2 = Net.FHttp(\"127.0.0.1\",80)\nHC2:setBasicAuthentication(user, pwd)\n  \nresponse = HC2:GET(\"/api/panels/event?last=50&type=id\")\n\nlocal t = json.decode(response)\nlocal j = 0\nfor i = 1, 50 do\n  local msg = fibaro:getName(t[i].deviceID) .. \" [\"..fibaro:getRoomName(fibaro:getRoomID(t[i].deviceID)) .. \"] | \" .. t[i].oldValue .. \"->\" .. t[i].newValue .. \" | \" .. os.date(\"%X\", t[i].timestamp)\n  if (t[i].deviceType == \"temperature_sensor\") then\n    -- pas interessant\n  else\n    j = j + 1\n\tpcall(function() \n    \tfibaro:call(fibaro:getSelfId(), \"setProperty\", \"ui.Label\"..j..\".value\", msg)\n\tend)\n  end\nend","buttonIcon":1088,"favourite":false,"main":true}]}]},"actions":{"pressButton":1,"setSlider":2,"setProperty":2}}